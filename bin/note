#!/usr/bin/env bash

if [[ ! -d ~/notes  ]]; then
	echo "Making notes directory..."
	mkdir ~/notes
	chmod -R 644 ~/notes/*
fi

if [[ -z $@ ]]; then
	echo "No name given"
	exit 1
fi

if [[ "$1" == "latest" ]]; then
	file=$(ls ~/notes | grep -E '^[0-9]{6}' | tail -n 1)
elif [[ "$1" == "todo" ]]; then
	file="todo"
else
	id=`date '+%y%m%d'`
	file="${id}_${@}.md"
fi

# now=`date '+%a_%d-%m-%Y_%T_%Z'`
# now=`date '+%s'`
# Latest id + 1
# id=`ls ~/notes | grep -e '[0-9]_' | sed 's/_.*//' | tail -n 1`
# ((id++))

path=$(printf ~/notes/%q "$file")

echo "Opening note $path"
vim "$path"
