#!/usr/bin/env python
import sys
from http.server import BaseHTTPRequestHandler, HTTPServer

class SimpleLoggerHandler(BaseHTTPRequestHandler):
    def do_ALL(self):
        content_length = int(self.headers.get('Content-Length', 0))
        body = self.rfile.read(content_length).decode('utf-8') if content_length else ''

        print(f"{self.command} {self.path} - Headers: {dict(self.headers)} - Body: {body}")

        self.send_response(200)
        self.end_headers()

    do_GET = do_POST = do_PUT = do_DELETE = do_PATCH = do_OPTIONS = do_ALL

if __name__ == '__main__':
    port = int(sys.argv[1]) if len(sys.argv) > 1 else 8000
    server_address = ('', port)
    httpd = HTTPServer(server_address, SimpleLoggerHandler)
    print(f"Serving on port {port}...")
    httpd.serve_forever()

